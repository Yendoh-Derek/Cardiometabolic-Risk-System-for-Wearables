This architecture is specifically designed to leverage the MIMIC-III Matched Subset, which is the gold standard for this project because it allows us to pair high-frequency waveforms (PPG/ECG) with ground-truth clinical outcomes (ICD-9 codes, Lab results, and Demographics) from the Clinical Database.1. High-Level System ArchitectureThe system follows a lambda-style architecture adapted for physiological data, separating the heavy batch training on MIMIC-III from the low-latency inference required for wearable signals.2. Detailed Component BreakdownA. Data Ingestion & Matching LayerSince you are using the Matched Subset, the first challenge is the "MIMIC Join."Signal Loader: Uses wfdb to stream .dat and .hea files.Clinical Linker: A Python service that joins the SUBJECT*ID and HADM_ID from the waveform headers to the D_ICD_DIAGNOSES and LABEVENTS tables in the clinical database.Label Generator: This creates your Cardiometabolic Ground Truth.Example: If a patient has ICD-9 codes 250.xx (Diabetes) and 401.xx (Hypertension), they are labeled "High Cardiometabolic Risk."B. The "Physio-Hybrid" Preprocessing PipelineThis layer transforms messy clinical waveforms into clean, windowed segments.SQI Gating: A 1D-CNN trained on labeled noise segments filters out sensor detachment or motion artifacts.Wavelet Denoising: Employs a Symlet-8 wavelet decomposition to strip away the high-frequency ventilator noise common in MIMIC data.Adaptive Windowing: Segments the signal into 30-second epochs with 50% overlap.C. The Dual-Stream Modeling EngineThis is where the "Physiologically Meaningful Features" meet "Deep Learning."Stream 1 (CNN Encoder): A 1D-ResNet that takes the raw window. It focuses on the Vascular Morphology.Output: A 64-dimension latent vector $z*{morph}$.Stream 2 (Classical Encoder): Extracts 42 specific HRV and Pulse Wave Analysis (PWA) features using NeuroKit2.Output: A feature vector $x_{physio}$.Stream 3 (Contextual Embedding): Processes Age, Sex, and BMI from the MIMIC Clinical records.Output: A demographic vector $x_{meta}$.D. Gated Fusion & Risk PredictionThe system uses a Multi-Head MLP to produce the final proxies:Head A (Classification): Risk level (Low/Medium/High).Head B (Regression): Estimated Arterial Stiffness (using Pulse Transit Time if ECG is present).3. Mathematical Objective FunctionTo ensure the model learns "Risk" and not just "Noise," we use a weighted Multi-Task Loss:$$\mathcal{L}_{total} = \lambda_1 \mathcal{L}_{risk} + \lambda_2 \mathcal{L}_{hrv\_recon} + \lambda_3 \mathcal{L}_{quality}$$Where:$\mathcal{L}_{risk}$: Cross-entropy for cardiometabolic labels.$\mathcal{L}_{hrv\_recon}$: Ensures the CNN latent space preserves HRV information.$\mathcal{L}_{quality}$: Penalty for confident predictions on low-SQI signals.4. Technical Stack for ImplementationModuleTechnologyData OrchestrationDagster or Prefect (Better than Airflow for data-heavy tasks).Signal ProcessingNumPy / SciPy / NeuroKit2 / WFDB.Feature StoreFeast or Parquet files on S3.DL FrameworkPyTorch Lightning (For multi-GPU scaling on MIMIC).ML FrameworkXGBoost / LightGBM (For the fusion head).InterpretabilitySHAP (Captures feature contribution).API LayerFastAPI with Pydantic validation.
